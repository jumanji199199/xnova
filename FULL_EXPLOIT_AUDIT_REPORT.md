# üîç –ü–û–õ–ù–´–ô –ê–£–î–ò–¢ –≠–ö–°–ü–õ–û–ô–¢-–ú–û–î–£–õ–ï–ô SOLANA

## üìã –û–±—â–∏–π –æ–±–∑–æ—Ä
**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2024-01-15  
**–ê—É–¥–∏—Ç–æ—Ä:** Expert Security Analyst  
**–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –û–ë–ù–ê–†–£–ñ–ï–ù–´ ‚ö†Ô∏è

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ù–ê–•–û–î–ö–ò

### 1. **account_exploit.py** - –û–ü–ê–°–ù–ê–Ø –õ–û–ì–ò–ö–ê –ü–ï–†–ï–í–û–î–ê
**–°—Ç—Ä–æ–∫–∏ 258-285:** –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ù–ê–û–ë–û–†–û–¢:
```python
# –®–ê–ì 1: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SOL –° –Ω–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞ –ù–ê —Ü–µ–ª–µ–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
transfer_ix = transfer(
    TransferParams(
        from_pubkey=self.attacker_keypair.pubkey(),  # ‚ùå –ú–´ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
        to_pubkey=target,                            # ‚ùå –¶–ï–õ–ò
        lamports=test_amount
    )
)

# –®–ê–ì 2: –ü—ã—Ç–∞–µ—Ç—Å—è –∏–∑–≤–ª–µ—á—å –æ–±—Ä–∞—Ç–Ω–æ
extract_ix = transfer(
    TransferParams(
        from_pubkey=target,                          # –¢–µ–ø–µ—Ä—å –∏–∑–≤–ª–µ–∫–∞–µ–º
        to_pubkey=self.our_target_pubkey,
        lamports=test_amount - 5000
    )
)
```
**–†–∏—Å–∫:** –ï—Å–ª–∏ —à–∞–≥ 2 –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –º—ã –¢–ï–†–Ø–ï–ú —Å—Ä–µ–¥—Å—Ç–≤–∞!

### 2. **token_exploit.py** - –ù–ï–í–ï–†–ù–ê–Ø –õ–û–ì–ò–ö–ê –í–õ–ê–î–ï–ù–ò–Ø
**–°—Ç—Ä–æ–∫–∏ 543-544:**
```python
owner=self.attacker_keypair.pubkey(),  # ‚ùå –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –ú–´ –≤–ª–∞–¥–µ–µ–º –∏—Å—Ö–æ–¥–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –≠–∫—Å–ø–ª–æ–π—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –∞—Ç–∞–∫—É—é—â–∏–π —É–∂–µ –≤–ª–∞–¥–µ–µ—Ç —Ç–æ–∫–µ–Ω-–∞–∫–∫–∞—É–Ω—Ç–æ–º –∂–µ—Ä—Ç–≤—ã. –≠—Ç–æ –Ω–µ —ç–∫—Å–ø–ª–æ–π—Ç, –∞ –æ–±—ã—á–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥!

### 3. **–í—Å–µ –º–æ–¥—É–ª–∏** - –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ò–ï, –ù–ï –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï
- –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π DeFi/DEX
- –ù–µ—Ç —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤ oracle manipulation
- –ù–µ—Ç sandwich/MEV –∞—Ç–∞–∫
- –ù–µ—Ç flash loan —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤

## üìä –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –º–æ–¥—É–ª—è–º

### **base_exploit.py** ‚úÖ (–ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å safety_checks
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ RPC endpoints
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PublicKey.from_string()

**–°–ª–∞–±–æ—Å—Ç–∏:**
- –ù–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö DeFi –º–µ—Ç–æ–¥–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏

### **account_exploit.py** ‚ùå (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´)
**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. **excess_lamports** (—Å—Ç—Ä–æ–∫–∏ 152-195): –ü—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å SOL –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç –≤–º–µ—Å—Ç–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
2. **buffer_overflow** (—Å—Ç—Ä–æ–∫–∏ 197-241): –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ mainnet
3. **account_migration** (—Å—Ç—Ä–æ–∫–∏ 243-290): –û–ü–ê–°–ù–ê–Ø –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –ª–æ–≥–∏–∫–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
- –£–±—Ä–∞—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —ç–∫—Å–ø–ª–æ–π—Ç—ã
- –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ DeFi —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### **token_exploit.py** ‚ö†Ô∏è (–ù–µ–≤–µ—Ä–Ω—ã–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è)
**–ü—Ä–æ–±–ª–µ–º—ã:**
1. **delegated_tokens** (—Å—Ç—Ä–æ–∫–∏ 236-274): –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –ú–´ –¥–µ–ª–µ–≥–∞—Ç—ã (—Ä–µ–¥–∫–æ)
2. **close_authority** (—Å—Ç—Ä–æ–∫–∏ 276-330): –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –ú–´ close authority (—Ä–µ–¥–∫–æ)
3. **unfrozen_tokens** (—Å—Ç—Ä–æ–∫–∏ 468-575): –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—à keypair –∫–∞–∫ owner —á—É–∂–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- excess_lamports_token - –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç–µ–æ—Ä–∏–∏

### **program_exploit.py** ü§î (–°–ª–∏—à–∫–æ–º –±–∞–∑–æ–≤—ã–π)
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –¢–æ–ª—å–∫–æ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø—É—Å—Ç—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
- –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö PDA —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤
- –ù–µ—Ç CPI manipulation
- –ù–µ—Ç Anchor discriminator spoofing

### **reentrancy_exploit.py** üìö (–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π)
**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π, –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º –∫ Solana
- Solana –Ω–µ –∏–º–µ–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö reentrancy –∫–∞–∫ Ethereum
- –ù—É–∂–Ω—ã —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ Solana –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### **memory_exploit.py** üî¨ (–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π)
**–°—Ç–∞—Ç—É—Å:** –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ PDF, –Ω–æ –Ω–µ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π
- –¢—Ä–µ–±—É–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Å–∞–º–æ–º validator
- –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º –∫ –æ–±—ã—á–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–∞–º
- –ë–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è security research

### **validator_exploit.py** üéØ (–ù–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π)
**–°—Ç–∞—Ç—É—Å:** –ß–∏—Å—Ç–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π
- RCE –≤ validator –∫—Ä–∞–π–Ω–µ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–µ–Ω
- –¢—Ä–µ–±—É–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∏–ª–∏ 0day
- –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üõ†Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–£

### 1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ö–†–ò–¢–ò–ß–ù–û)**
```python
# account_exploit.py - –∏—Å–ø—Ä–∞–≤–∏—Ç—å excess_lamports
async def _exploit_excess_lamports(self, target: PublicKey, vuln: AccountVulnerability):
    # –¢–û–õ–¨–ö–û –∏–∑–≤–ª–µ–∫–∞–µ–º, –ù–ò–ö–û–ì–î–ê –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ target
    excess = vuln.details["excess_lamports"]
    
    # –°–æ–∑–¥–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–∞–ø—Ä—è–º—É—é
    withdraw_ix = withdraw_excess_lamports(
        from_account=target,
        to_account=self.our_target_pubkey,
        amount=excess
    )
```

### 2. **–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ DeFi —ç–∫—Å–ø–ª–æ–π—Ç—ã**
```python
# –ù–æ–≤—ã–π —Ñ–∞–π–ª: defi_exploits.py
class DeFiExploits:
    async def exploit_amm_price_manipulation(self, pool: PublicKey):
        """–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è —Ü–µ–Ω–æ–π –≤ AMM –ø—É–ª–∞—Ö"""
        
    async def exploit_oracle_delay(self, oracle: PublicKey):
        """–≠–∫—Å–ø–ª–æ–π—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è oracle"""
        
    async def sandwich_attack(self, target_tx: str):
        """MEV sandwich –∞—Ç–∞–∫–∞"""
        
    async def flash_loan_attack(self, protocol: PublicKey):
        """Flash loan –¥–ª—è –∞—Ä–±–∏—Ç—Ä–∞–∂–∞"""
```

### 3. **–§–æ–∫—É—Å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö**
- **Serum DEX**: –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å order book
- **Raydium/Orca**: AMM price manipulation  
- **Solend/Mango**: Liquidation exploits
- **Pyth/Switchboard**: Oracle delays
- **Token2022**: –ù–æ–≤—ã–µ extension —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 4. **–£–¥–∞–ª–∏—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏**
- memory_exploit.py ‚Üí –∞—Ä—Ö–∏–≤
- validator_exploit.py ‚Üí –∞—Ä—Ö–∏–≤
- –§–æ–∫—É—Å –Ω–∞ program_exploit.py —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ PDA/CPI –±–∞–≥–∞–º–∏

## üìà –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

1. **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–ø–∞—Å–Ω—É—é –ª–æ–≥–∏–∫—É –≤ account_exploit.py
2. **üü† –í–ê–ñ–ù–û:** –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å token_exploit.py –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
3. **üü° –°–†–ï–î–ù–ï:** –î–æ–±–∞–≤–∏—Ç—å DeFi-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —ç–∫—Å–ø–ª–æ–π—Ç—ã
4. **üü¢ –ù–ò–ó–ö–û:** –£–ª—É—á—à–∏—Ç—å program_exploit.py –¥–ª—è Anchor/PDA

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** –∏ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö** —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö –≤–º–µ—Å—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö. –ù–µ–æ–±—Ö–æ–¥–∏–º –ø–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ —Ü–µ–ª–µ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
2. **–ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å**: DeFi, DEX, Oracle, MEV —ç–∫—Å–ø–ª–æ–π—Ç—ã
3. **–†–µ–∞–ª—å–Ω–æ—Å—Ç—å**: –£–±—Ä–∞—Ç—å validator/memory —ç–∫—Å–ø–ª–æ–π—Ç—ã
4. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ DeFi —ç–∫—Å–ø–ª–æ–π—Ç—ã.
