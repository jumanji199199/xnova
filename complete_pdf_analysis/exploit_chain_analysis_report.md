# Solana RCE Exploit Chain Analysis

## Pwning Blockchain for Fun and Profit - Solana RCE Exploit Chain

**Vulnerability**: CVE in Solana validator leading to RCE

## Exploit Flow

### Stage 1: Understanding Solana Architecture
**Pages**: 1-9

**Key Concepts**:
- AccountSharedData structure
- Program execution model
- Transaction model
- Memory management

**Images**: 0 images

---

### Stage 2: Legacy Data Exposure
**Pages**: 10-34

**Key Concepts**:
- Account serialization vulnerabilities
- AccountInfo construction bugs
- Write permission check bypass
- Memory layout exploitation

**Critical Finding**: Unsafe memory exposure through legacy AccountInfo

**Images**: 18 images

---

### Stage 3: Legacy Interoperability (CPI)
**Pages**: 35-50

**Key Concepts**:
- Cross-Program Invocation (CPI) vulnerabilities
- CPI return value manipulation
- Account state corruption through CPI

**Critical Finding**: CPI can be abused to corrupt account states

**Images**: 13 images

---

### Stage 4: New Data Exposure
**Pages**: 51-66

**Key Concepts**:
- New account serialization bugs
- Copy-on-Write (CoW) vulnerabilities
- Reserved data buffer exploitation

**Critical Finding**: New serialization format still vulnerable

**Images**: 14 images

---

### Stage 5: VM Memory Management Exploitation
**Pages**: 67-89

**Key Concepts**:
- Memory Regions manipulation
- Direct Mapping vulnerabilities
- Host_Addr update bugs
- MemoryRegion.State manipulation

**Critical Finding**: VM memory regions can be corrupted

**Images**: 25 images

---

### Stage 6: New Interoperability Exploitation
**Pages**: 90-108

**Key Concepts**:
- New CPI implementation bugs
- MemoryRegion.Host_Addr update vulnerabilities
- Guest address validation bypass

**Critical Finding**: Missing guest address validation

**Images**: 18 images

---

### Stage 7: Bug Chain Construction
**Pages**: 109-142

**Key Concepts**:
- Missing check of guest address when updating MemoryRegion
- Out of bounds write to Account2 Databuf
- Memory corruption chain

**Critical Finding**: Multiple bugs can be chained for memory corruption

**Images**: 36 images

---

### Stage 8: Final Exploit - Arbitrary Read/Write to RCE
**Pages**: 143-165

**Key Concepts**:
- Matching MemoryRegion for controlled memory
- Cell<u64> manipulation for arbitrary read/write
- 0xdeadbeef marker for exploit verification
- RCE achievement through memory corruption

**Critical Finding**: Arbitrary read/write leads to RCE in Solana validator

**Images**: 18 images

---

## Implementation Techniques

### memory_exploit
- Guest address validation bypass
- MemoryRegion manipulation
- Cell<u64> arbitrary read/write
- VM heap corruption

### validator_exploit
- Validator memory corruption
- RCE through corrupted memory regions
- Process control hijacking

### account_exploit
- AccountInfo serialization bugs
- Write permission bypass
- Account state manipulation

### program_exploit
- CPI vulnerabilities
- Program state corruption
- Cross-program attacks

